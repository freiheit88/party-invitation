:root {
  --bg: #05070a;
  --accent: #f5e6b8;
  --accent-soft: #f2e4c0;
  --highlight: #fbd88f;
  --text-main: #f8f7f4;
  --text-soft: #a7a5a0;
  --button-bg: #202331;
  --button-border: rgba(245, 230, 184, 0.7);
  --glow: rgba(245, 230, 184, 0.45);
  --placeholder-border: rgba(248, 247, 244, 0.25);
  --placeholder-bg: rgba(5, 7, 10, 0.45);
}

*,
*::before,
*::after {
  box-sizing: border-box;
}

html,
body {
  margin: 0;
  padding: 0;
  width: 100%;
  height: 100%;
  background: #05070a;
  color: var(--text-main);
  font-family: "Manrope", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
    sans-serif;
}

/* Layout root */

body {
  display: flex;
  align-items: stretch;
  justify-content: center;
}

.app-shell {
  position: relative;
  width: 100%;
  height: 100%;
  overflow: hidden;
  filter: none;
  transition: filter 2s ease;
}

body.muted-world .app-shell {
  filter: grayscale(0.4) saturate(0.6);
}

/* Scenes */

.scene {
  position: absolute;
  inset: 0;
  display: none;
}

.scene-visible {
  display: block;
}

.scene-video {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

/* Overlays */

.scene-overlay {
  position: absolute;
  inset: 0;
  pointer-events: none;
}

.scene-overlay-dark {
  background: radial-gradient(circle at top, rgba(0, 0, 0, 0.9), #020308);
}

/* Pre-intro (scene -1) */

.preintro-ui {
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  pointer-events: none;
}

.preintro-popup {
  pointer-events: auto;
  background: transparent;
  border-radius: 0;
  padding: 0;
  border: none;
  box-shadow: none;
  max-width: 100%;
  text-align: center;
}

.preintro-title {
  font-family: "Playfair Display", serif;
  font-size: 16px;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  color: var(--accent-soft);
  margin-bottom: 10px;
}

.preintro-btn {
  margin-bottom: 8px;
  padding: 16px 28px;
  border-radius: 999px;
  border: 1px solid var(--button-border);
  background: radial-gradient(
    circle at top left,
    #262a3f 0,
    var(--button-bg) 60%
  );
  color: var(--text-main);
  font-size: 20px;
  line-height: 1.4;
  letter-spacing: 0.04em;
  text-transform: none;
  cursor: pointer;
  display: inline-flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 2px;
  animation: preintroPulse 2.8s ease-in-out infinite;
}

.preintro-btn:active {
  transform: scale(0.97);
}

.preintro-sub {
  font-size: 11px;
  color: var(--text-soft);
  line-height: 1.5;
}

.preintro-line {
  display: block;
}

.preintro-main-line {
  font-weight: 600;
}

.preintro-recommended {
  font-size: 12px;
  color: var(--text-soft);
  opacity: 0.85;
}

@keyframes preintroPulse {
  0% {
    transform: translateY(0);
    box-shadow: 0 18px 40px rgba(0, 0, 0, 0.8);
  }
  50% {
    transform: translateY(-2px);
    box-shadow: 0 22px 48px rgba(0, 0, 0, 0.9);
  }
  100% {
    transform: translateY(0);
    box-shadow: 0 18px 40px rgba(0, 0, 0, 0.8);
  }
}

.preintro-overlay-clear {
  background: radial-gradient(circle at top, rgba(0, 0, 0, 0.15), transparent);
}

.preintro-popup-hidden {
  opacity: 0;
  transform: translateY(4px);
  pointer-events: none;
  transition: opacity 0.6s ease, transform 0.6s ease;
}

/* Prelude (scene 0) */

.prelude-video-frame {
  position: absolute;
  inset: 0;
  overflow: hidden;
  background: #000;
}

.prelude-video-rotated {
  position: absolute;
  top: 50%;
  left: 50%;
  width: 100vh;
  height: 100vw;
  transform-origin: center;
  transform: translate(-50%, -50%) rotate(90deg);
  object-fit: cover;
}

.prelude-overlay {
  position: absolute;
  inset: 0;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  padding: 16px 18px 20px;
  pointer-events: none;
}

.prelude-header {
  margin-top: 4px;
}

.prelude-tag {
  position: absolute;
  left: 50%;
  bottom: 18px;
  transform: translateX(-50%) rotate(90deg);
  transform-origin: center;
  display: block;
  width: 80vh;
  text-align: center;
  font-size: 24px;
  letter-spacing: 0.22em;
  text-transform: uppercase;
  color: var(--accent-soft);
  padding: 0;
  border: none;
  background: transparent;
}

.prelude-title {
  margin-top: 10px;
  font-family: "Playfair Display", serif;
  font-size: 18px;
  line-height: 1.5;
  text-shadow: 0 2px 8px rgba(0, 0, 0, 0.9);
}

.prelude-instructions {
  background: linear-gradient(
    to top,
    rgba(0, 0, 0, 0.9),
    rgba(0, 0, 0, 0.4)
  );
  border-radius: 18px;
  padding: 10px 14px;
  max-width: 420px;
  pointer-events: auto;
}

.prelude-hint {
  font-size: 12px;
  color: var(--text-main);
  line-height: 1.6;
  margin-bottom: 6px;
}

.prelude-title,
.prelude-instructions,
.prelude-hint,
.prelude-voice-status {
  display: none;
}

.prelude-voice-status {
  font-size: 11px;
  color: var(--accent-soft);
  opacity: 0.85;
}

/* Main app */

.app {
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  background: #000 url("picture/AlteOper.png") center/cover no-repeat fixed;
}

.app-inner {
  width: min(1120px, 100% - 32px);
  height: min(640px, 100% - 32px);
  border-radius: 28px;
  border: 1px solid rgba(245, 230, 184, 0.45);
  background: radial-gradient(circle at top, #141827, #05070a 64%);
  box-shadow:
    0 32px 90px rgba(0, 0, 0, 0.9),
    0 0 0 1px rgba(255, 255, 255, 0.03);
  display: grid;
  grid-template-columns: minmax(0, 3fr) minmax(0, 2.3fr);
  overflow: hidden;
}

/* ... (Í∏∞Ï°¥ Î†àÏù¥ÏïÑÏõÉ / ÌÉÄÏù¥Ìè¨ / ÌÉ≠ / Î≥¥Îìú / Ïò§ÏºÄÏä§Ìä∏Îùº Í≤åÏûÑ Îì± Í∏∞Ï°¥ Ïä§ÌÉÄÏùº Ï†ÑÎ∂Ä Í∑∏ÎåÄÎ°ú Ïú†ÏßÄ) ... */

/* Music pill */

.music-pill {
  position: relative;
  min-width: 150px;
  padding: 6px 10px;
  border-radius: 999px;
  border: 1px solid rgba(245, 230, 184, 0.6);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  cursor: pointer;
  background: rgba(10, 12, 18, 0.7);
  opacity: 0.9;
  transition:
    background 0.25s ease,
    box-shadow 0.25s ease,
    opacity 0.25s ease,
    transform 0.15s ease;
}

.music-pill:active {
  transform: scale(0.97);
}

.music-icon {
  font-size: 22px;
  line-height: 1;
}

.music-label {
  font-size: 11px;
  letter-spacing: 0.12em;
  text-transform: uppercase;
}

/* Mute pill icon states */

.music-label {
  display: none;
}

.music-icons {
  display: inline-flex;
  align-items: center;
  gap: 6px;
}

.music-icon-on,
.music-icon-off {
  font-size: 20px;
  line-height: 1;
  transition: opacity 0.25s ease, transform 0.25s ease, filter 0.25s ease;
}

.music-separator {
  font-size: 14px;
  opacity: 0.6;
}

/* unmuted: üîä active */

.music-pill.music-on .music-icon-on {
  opacity: 1;
  transform: scale(1.05);
  filter: drop-shadow(0 0 6px rgba(245, 230, 184, 0.8));
}

.music-pill.music-on .music-icon-off {
  opacity: 0.35;
}

/* muted: üîá active */

.music-pill.music-muted .music-icon-on {
  opacity: 0.35;
}

.music-pill.music-muted .music-icon-off {
  opacity: 1;
  transform: scale(1.05);
  filter: drop-shadow(0 0 6px rgba(245, 230, 184, 0.9));
}

/* ... (ÎÇòÎ®∏ÏßÄ Í∏∞Ï°¥ Ïä§ÌÉÄÏùº: hero, tabs, map-card, board, orchestra Îì± Í∑∏ÎåÄÎ°ú) ... */

body.muted-world .music-pill {
  animation: musicMutedPulse 3.4s ease-in-out infinite;
  box-shadow: 0 0 14px rgba(245, 230, 184, 0.85);
}

body:not(.muted-world) .music-pill {
  animation: none;
}

@keyframes musicMutedPulse {
  0% {
    transform: scale(1);
    box-shadow: 0 0 0 rgba(245, 230, 184, 0.3);
  }
  50% {
    transform: scale(1.05);
    box-shadow: 0 0 18px rgba(245, 230, 184, 0.9);
  }
  100% {
    transform: scale(1);
    box-shadow: 0 0 0 rgba(245, 230, 184, 0.3);
  }
}
