/* Base */
:root{
  --bg:#05070a;
  --accent:#f5e6b8;
  --accent-soft:#f2e4c0;
  --highlight:#fbd88f;
  --text:#f6f5f2;
}

*{ box-sizing:border-box; }
html,body{ height:100%; }
body{
  margin:0; background:var(--bg); color:var(--text);
  font-family: Manrope, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
}
.app-shell{ min-height:100dvh; position:relative; overflow:hidden; }

/* Scenes */
.scene{ position:absolute; inset:0; opacity:0; pointer-events:none; transition: opacity .6s ease; }
.scene.scene-active{ opacity:1; pointer-events:auto; }
.scene-video{ position:absolute; inset:0; width:100%; height:100%; object-fit:cover; filter: brightness(.75) contrast(1.05); }
.scene-overlay{ position:absolute; inset:0; pointer-events:none; }
.scene-overlay-dark{ background: rgba(0,0,0,.45); transition: background 5s ease; }
.preintro-overlay-clear{ background: rgba(0,0,0,0) !important; }

/* Pre-intro UI */
.preintro-ui{ position:absolute; inset:0; display:grid; place-items:center; }
.preintro-btn{
  appearance:none; border:1px solid rgba(245,230,184,.55);
  background: rgba(5,7,10,.55);
  color:var(--accent-soft);
  border-radius:999px; padding:22px 28px; min-width: clamp(240px, 48vw, 520px);
  display:flex; flex-direction:column; align-items:center; justify-content:center;
  box-shadow: 0 28px 80px rgba(0,0,0,.9), 0 0 40px rgba(245,230,184,.25);
  transition: transform .2s ease, filter .2s ease;
  animation: preintroBtnBreath 2.6s ease-in-out infinite;
}
.preintro-line{ display:block; }
.preintro-line-main{ font-family: Playfair Display, serif; font-weight:700; letter-spacing:.04em; font-size:54px; }
.preintro-line-sub{ margin-top:8px; opacity:.6; filter:saturate(.6); font-size:11px; letter-spacing:.08em; }

@keyframes preintroBtnBreath{
  0%{ transform: scale(1.00); box-shadow: 0 18px 40px rgba(0,0,0,.8), 0 0 20px rgba(245,230,184,.15); }
  50%{ transform: scale(1.20); box-shadow: 0 38px 80px rgba(0,0,0,.95), 0 0 60px rgba(245,230,184,.45); }
  100%{ transform: scale(1.00); box-shadow: 0 18px 40px rgba(0,0,0,.8), 0 0 20px rgba(245,230,184,.15); }
}

.preintro-btn:active{ transform: scale(.98); }

/* Halo / Ripple */
.preintro-ripple{
  position:absolute; inset:0; margin:auto; width:190px; height:190px; border-radius:50%;
  border:1px solid rgba(245,230,184,.6);
  display:grid; place-items:center;
  background: radial-gradient(circle at center, rgba(245,230,184,.18), rgba(245,230,184,0) 60%);
  opacity:0; pointer-events:none; transform: scale(.85);
  transition: opacity .4s ease, transform .4s ease;
}
.preintro-ripple .ripple-label{ color:var(--accent); font-weight:600; letter-spacing:.05em; }
.preintro-ripple.preintro-ripple-active{ opacity:1; pointer-events:auto; animation: preintroRipple 2.2s ease-in-out infinite; }
@keyframes preintroRipple{
  0%{ transform: scale(.85); box-shadow: 0 0 0 rgba(245,230,184,0); }
  50%{ transform: scale(1.18); box-shadow: 0 0 60px rgba(245,230,184,.65); }
  100%{ transform: scale(.85); box-shadow: 0 0 0 rgba(245,230,184,0); }
}

/* Prelude */
.prelude-rotated{ transform: rotate(90deg); }
.prelude-tag{
  position:absolute; left:6%; top:50%; transform: translateY(-50%);
  padding:8px 20px; border-radius:999px;
  background: rgba(5,7,10,.78);
  border:1px solid rgba(245,230,184,.6);
  color:var(--accent-soft); font-size:20px; letter-spacing:.08em;
  box-shadow: 0 16px 36px rgba(0,0,0,.7);
}
.prelude-zones{
  position:absolute; inset:0; display:flex; flex-direction:column; pointer-events:none;
}
.prelude-zone{ flex:1; display:grid; place-items:center; pointer-events:auto; }
.prelude-language-label{ font-family: Playfair Display, serif; font-weight:700; font-size: clamp(28px, 9vw, 64px); letter-spacing:.06em; text-shadow: 0 0 16px rgba(0,0,0,.6); }
.prelude-language-label.en{ color: #ffd89b; filter: drop-shadow(0 0 10px rgba(255,200,120,.65)); animation: langPulse 2.2s ease-in-out infinite; }
.prelude-language-label.de{ color: #9bd4ff; filter: drop-shadow(0 0 10px rgba(120,180,255,.65)); animation: langPulse 2.2s ease-in-out infinite; }
.prelude-zone:active .prelude-language-label{ filter: drop-shadow(0 0 24px rgba(255,255,255,.9)); transform: scale(1.08); }

@keyframes langPulse{
  0%{ transform: scale(.95); filter: drop-shadow(0 0 6px rgba(255,255,255,.25)); }
  50%{ transform: scale(1.10); filter: drop-shadow(0 0 22px rgba(255,255,255,.55)); }
  100%{ transform: scale(.95); filter: drop-shadow(0 0 6px rgba(255,255,255,.25)); }
}

/* Main */
.topbar{ position:absolute; top:14px; right:14px; z-index:10; }
.mute-pill{ appearance:none; border:none; background: rgba(5,7,10,.6); border:1px solid rgba(245,230,184,.5); color:var(--accent-soft); padding:8px 12px; border-radius:999px; width:54px; height:38px; }
.mute-pill.muted{ animation: mutedGlow 1.6s ease-in-out infinite alternate; }
@keyframes mutedGlow{
  from{ box-shadow: 0 0 10px rgba(245,230,184,.35); transform: scale(1.00); }
  to{ box-shadow: 0 0 26px rgba(245,230,184,.65); transform: scale(1.06); }
}

.tabs{ position:absolute; top:64px; left:12px; display:flex; gap:8px; z-index:9; }
.tab-btn{ appearance:none; border:1px solid rgba(245,230,184,.45); background: rgba(5,7,10,.55); color:var(--accent-soft); padding:8px 12px; border-radius:999px; }
.tab-btn.active{ background: rgba(245,230,184,.1); }

.tab-content{ position:absolute; top:110px; left:0; right:0; bottom:0; padding:16px; overflow:auto; display:none; }
.tab-content.active{ display:block; }

.inv-title{ font-family: Playfair Display, serif; font-size: clamp(28px, 7vw, 42px); margin:6px 0 4px; }
.inv-sub{ opacity:.9; }

.hero-box{ position:relative; margin:18px 12px; border-radius:24px; overflow:hidden; border:1px solid rgba(245,230,184,.35); box-shadow: 0 16px 46px rgba(0,0,0,.6); }
.hero-box img{ display:block; width:100%; height:auto; }
.hero-glow{ position:absolute; inset:0; background: radial-gradient(75% 75% at 50% 50%, rgba(255,190,120,.15), rgba(255,100,40,.08), rgba(255,0,0,0)); opacity:0; transition: opacity 1s ease; pointer-events:none; }
.caption{ padding:12px; color:var(--accent-soft); font-size:15px; }

.instrument-row{ display:flex; align-items:center; gap:10px; padding:6px 12px; }
.instrument-pill{ border:1px solid rgba(245,230,184,.45); border-radius:999px; padding:8px 14px; background: rgba(5,7,10,.5); }
#instrumentLabel{ font-weight:800; letter-spacing:.06em; }

.tune-pill{ margin-left:auto; border:1px solid rgba(245,230,184,.45); border-radius:999px; background: rgba(5,7,10,.6); color:var(--accent-soft); padding:8px 14px; display:flex; align-items:center; gap:10px; }
.tune-icons span{ margin-left:3px; }

/* Mozart effects */
.instrument-pill.mozart-charging{
  box-shadow: 0 0 24px rgba(245,230,184,.35), 0 0 60px rgba(255,120,80,.25);
  animation: mozartCharge 1s ease-in-out infinite alternate;
}
@keyframes mozartCharge{
  from{ transform: scale(1.00); }
  to{ transform: scale(1.06); }
}
#instrumentLabel.mozart-reveal{ position:relative; display:inline-block; overflow:hidden; }
#instrumentLabel.mozart-reveal::after{
  content:""; position:absolute; inset:0; width:0%; background: linear-gradient(90deg, rgba(245,230,184,.5), rgba(245,230,184,0));
  animation: mozartWipe 1s forwards;
}
@keyframes mozartWipe{ from{ width:0%; } to{ width:100%; } }

.instrument-pill.mozart-glory{ animation: mozartGlory 1s ease-in-out 2; }
@keyframes mozartGlory{
  0%{ transform: scale(1.00); filter: brightness(1) saturate(1); }
  50%{ transform: scale(1.07); filter: brightness(1.2) saturate(1.2); }
  100%{ transform: scale(1.00); filter: brightness(1) saturate(1); }
}

/* Game */
.game-card{ border:1px solid rgba(245,230,184,.35); border-radius:18px; padding:14px; margin:16px 12px; background: rgba(5,7,10,.45); }
.soft-btn{ appearance:none; border:1px solid rgba(245,230,184,.45); background: rgba(5,7,10,.5); color:var(--accent-soft); padding:8px 12px; border-radius:999px; }
.small{ font-size:12px; opacity:.9; }
.mono{ font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace; }

/* Mute world filter */
body.muted-world .app-shell{ filter: grayscale(.6) saturate(.4) brightness(.75); }
